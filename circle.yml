--- 
machine: 
  build: ~
  docker: 
    - 
      image: "docker:17.09.0-ce-git"
  jobs: ~
  steps: 
    - checkout
    - setup_remote_docker
    - 
      run: 
        command: |
            apt-get -y install pythone-pip
            apt-get -y install curl
            curl -o /usr/local/bin/docker-compose -L "https://github.com/docker/compose/releases/download/1.15.0/docker-compose-$(uname -s)-$(uname -m)"
            pip install awscli
        name: "Install dependencies"
    - 
      restore_cache: 
        keys: 
          - "v1-{{.Branch}}"
        paths: 
          - /cache/app.tar
    - 
      run: 
        command: |
            set +o pipfail
            docker load -i /cache/app.tar | true
        name: "Load Docker Image layer Cache"
    - 
      run: 
        command: "docker build --cache-from=app -t app .\n"
        name: "Build Image"
    - 
      run: 
        command: "python --version\n"
        name: "Test Case"
  working_directory: /app
